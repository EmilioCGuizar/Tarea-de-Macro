Serie_1 <- salr$Serie_1
vol_s1 <- sd(Serie_1, na.rm = T)
# Cambio Porcentual
empleo <- read_excel("Empleo.xls",
sheet = 1)
empleo$Periodos <- year(parse_date_time(empleo$Periodos, orders = "%Y/%q"))
empleo <- empleo %>% group_by(Periodos) %>% summarise(`PEA Ocupada`, PEA_Ocup_anualizado = mean(`PEA Ocupada`, na.rm=T), .groups = 'drop')
empleo <- empleo[!duplicated(empleo[c('PEA_Ocup_anualizado')]),]
empleo <- empleo %>% mutate(Serie_2 = (PEA_Ocup_anualizado/lag(PEA_Ocup_anualizado)-1)*100)
empleo <- empleo[,c(1,3,4)]
empleo <- na.omit(empleo)
knitr::kable(
empleo, booktabs = TRUE, format = 'latex', col.names = c("Año", "Población Ocupada","Variación %"),
caption = "Variación Porcentual de la Población Ocupada (2006 - 2021)", longtable = F
)%>%
kable_styling(latex_options = "hold_position")
# Volatilidad
Serie_2 <- empleo$Serie_2
vol_s2 <- sd(Serie_2, na.rm = T)
#Cambio Porcentual
datos <- read_excel("PIB_K.xls",
sheet = 1)
names(datos) = c('Periodo', 'Inversión', 'Indice K','PIB')
datos <- datos[-c(1:200),-c(2,3)]
datos$Periodo <- year(parse_date_time(datos$Periodo, orders = "%Y%q"))
datos <- na.omit(datos)
datos$PIB <- as.numeric(as.character(datos$PIB))
datos <- datos %>% group_by(Periodo) %>% summarise(PIB, PIB_an = mean(PIB), .groups = 'drop')
datos <- datos[!duplicated(datos[c('PIB_an')]),]
datos <- datos[,-2]
datos_pib <- datos %>% mutate(Serie_3 = (PIB_an/lag(PIB_an)-1)*100)
datos_pib <- na.omit(datos_pib)
knitr::kable(
datos_pib, booktabs = TRUE, format = 'latex', col.names = c("Año", "Producto Interno Bruto","Variación %"),
caption = "Variación Porcentual de los Salarios Reales (2008 - 2021)", longtable = F
)%>%
kable_styling(latex_options = "hold_position")
#Volatilidad
Serie_3 <- datos_pib$Serie_3
vol_s3 <- sd(Serie_3, na.rm = T)
Series <- datos_pib[,c(1,3)]
year <- datos_pib$Periodo
year <- year[-c(1,2)]
Serie1 <- salr$Serie_1
Serie2 <- empleo$Serie_2
Serie2 <- Serie2[-c(1,2)]
Serie3 <- datos_pib$Serie_3
Serie3 <- Serie3[-c(1,2)]
Series <- data.frame(year, Serie1, Serie2, Serie3)
pacman::p_load(extrafont)
meltdf <- melt(Series,id="year")
gg <- ggplot(meltdf,aes(x=year,y=value,colour=variable,group=variable)) + geom_line() +
labs(title = "Comparación de Variación Porcentual entre Series", x="Año",y='Variación Porcentual',
colour = " ") + theme_bw() +  theme(text=element_text(size=12,  family="serif"))
plot(gg)
# cov(Serie1[-1], Serie3[-1])
# cov(Serie_2, Serie_3)
#Cambio Porcentual
datos <- read_excel("PIB_K.xls",
sheet = 1)
names(datos) = c('Periodo', 'Inversión', 'Indice_K','PIB')
datos <- datos[-c(1:200),-2]
PIB <- datos[,-2]
PIB$Periodo <- year(parse_date_time(datos$Periodo, orders = "%Y%q"))
PIB <- na.omit(PIB)
PIB$PIB <- as.numeric(as.character(PIB$PIB))
PIB <- PIB %>% group_by(Periodo) %>% summarise(PIB, PIB_an = mean(PIB), .groups = 'drop')
PIB <- PIB[!duplicated(PIB[c('PIB_an')]),]
PIB <- PIB[,-2]
K <- datos[,-3]
K$Periodo <- year(parse_date_time(K$Periodo, orders = "%Y%m"))
K$Indice_K <- as.numeric(as.character(K$Indice_K))
K <- K %>% group_by(Periodo) %>% summarise(Indice_K, K_an = mean(Indice_K), .groups = 'drop')
K <- K[!duplicated(K[c('K_an')]),]
K <- na.omit(K)
K <- K[,-2]
empleo <- read_excel("Empleo.xls",
sheet = 1)
empleo$Periodos <- year(parse_date_time(empleo$Periodos, orders = "%Y/%q"))
empleo <- empleo %>% group_by(Periodos) %>% summarise(`PEA Ocupada`, PEA_Ocup_an = mean(`PEA Ocupada`, na.rm=T), .groups = 'drop')
empleo <- empleo[!duplicated(empleo[c('PEA_Ocup_an')]),]
empleo <- empleo
productividad <- empleo[,-2]
A <- PIB$PIB_an/(((K$K_an)^(0.3))*((empleo$PEA_Ocup_an)^(0.7)))
A <- as.vector(A, mode = "numeric")
A <- as.data.frame(A,t(A))
productividad <- productividad %>% add_column(A_t=A$A)
salario <- empleo[,-2]
w <- (0.7)*(productividad$A_t)*((K$K_an)^(0.3))*((empleo$PEA_Ocup_an)^(0.3))
w <- as.vector(w, mode = "numeric")
w <- as.data.frame(w,t(w))
salario <- salario %>% add_column(w=w$w)
t119 <- read_csv("sdemt119.csv")
t219 <- read_csv("sdemt219.csv")
t319 <- read_csv("sdemt319.csv")
names(t319) <- tolower(names(t319))
t419 <- read_csv("sdemt419.csv")
names(t419) <- tolower(names(t419))
#Población Econóicamente Activa
PEA1 <- as.numeric(filter(t119, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98, clase1 == 1) %>% summarise(sum(fac)))
PEA2 <- as.numeric(filter(t219, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98, clase1 == 1) %>% summarise(sum(fac)))
PEA3 <- as.numeric(filter(t319, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98, clase1 == 1) %>% summarise(sum(fac)))
PEA4 <- as.numeric(filter(t419, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98, clase1 == 1) %>% summarise(sum(fac)))
#Población Ocupada
PO1 <- as.numeric(filter(t119, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98, clase2 == 1) %>% summarise(sum(fac)))
PO2 <- as.numeric(filter(t219, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98, clase2 == 1) %>% summarise(sum(fac)))
PO3 <- as.numeric(filter(t319, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98, clase2 == 1) %>% summarise(sum(fac)))
PO4 <- as.numeric(filter(t419, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98, clase2 == 1) %>% summarise(sum(fac)))
#Población Desocupada
PD1 <- as.numeric(filter(t119, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98, clase2 == 2) %>% summarise(sum(fac)))
PD2 <- as.numeric(filter(t219, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98, clase2 == 2) %>% summarise(sum(fac)))
PD3 <- as.numeric(filter(t319, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98, clase2 == 2) %>% summarise(sum(fac)))
PD4 <- as.numeric(filter(t419, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98, clase2 == 2) %>% summarise(sum(fac)))
#Tasa de desempleo
U_1 <- (PD1/PEA1)*100
U_2 <- (PD2/PEA2)*100
U_3 <- (PD3/PEA3)*100
U_4 <- (PD4/PEA4)*100
unemp <- data.frame(Desempleo = c(U_1,U_2,U_3,U_4),
row.names = c('Trimestre I','Trimestre II','Trimestre III','Trimestre IV'))
knitr::kable(unemp, booktabs = TRUE, format = 'latex', longtable = F
)%>%
kable_styling(latex_options = "hold_position", "center")
unemp_ <- data.frame(Trimestre = c(' I',' II',' III',' IV'),
desmp = c(U_1,U_2,U_3,U_4))
g1 <- ggplot(unemp_, aes(Trimestre,desmp)) + geom_bar(stat = "identity", fill = "darkolivegreen2", color = "black", width = 0.6) + theme_bw() + labs(title = "Tasa de Desempleo 2019", xlab = " Trimestre ", y="Porcentaje") +  theme(text=element_text(size=12,  family="serif"))
#Población Subocupada
Sub1 <- as.numeric(filter(t119, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98, sub_o==1) %>% summarise(sum(fac)))
Sub2 <- as.numeric(filter(t219, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98, sub_o==1) %>% summarise(sum(fac)))
Sub3 <- as.numeric(filter(t319, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98, sub_o==1) %>% summarise(sum(fac)))
Sub4 <- as.numeric(filter(t419, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98, sub_o==1) %>% summarise(sum(fac)))
#Tasa de Subocupación
Tsub_1 <- (Sub1/PO1)*100
Tsub_2 <- (Sub2/PO2)*100
Tsub_3 <- (Sub3/PO3)*100
Tsub_4 <- (Sub4/PO4)*100
suboc <- data.frame(Subempleo = c(Tsub_1, Tsub_2, Tsub_3, Tsub_4),
row.names = c('Trimestre I','Trimestre II','Trimestre III','Trimestre IV'))
knitr::kable(suboc, booktabs = TRUE, format = 'latex', longtable = F
)%>%
kable_styling(latex_options = "hold_position", "center")
suboc_ <- data.frame(Trimestre = c(' I',' II',' III',' IV'),
subOC = c(Tsub_1, Tsub_2, Tsub_3, Tsub_4))
g2 <- ggplot(suboc_, aes(Trimestre,subOC)) + geom_bar(stat = "identity", fill = "darkorange2", color = "black", width = 0.6) + theme_bw() + labs(title = "Tasa de Subempleo 2019", xlab = " Trimestre ", y="Porcentaje") +  theme(text=element_text(size=12,  family="serif"))
#Población Disponible
disp1 <- as.numeric(filter(t119, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98, clase2 == 3, clase1==2) %>% summarise(sum(fac)))
disp2 <- as.numeric(filter(t219, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98,  clase2 == 3, clase1==2) %>% summarise(sum(fac)))
disp3 <- as.numeric(filter(t319, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98,  clase2 == 3, clase1==2) %>% summarise(sum(fac)))
disp4 <- as.numeric(filter(t419, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98,  clase2 == 3, clase1==2) %>% summarise(sum(fac)))
#Población No Disponible
nd1 <- as.numeric(filter(t119, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98, clase2 == 4, clase1==2) %>% summarise(sum(fac)))
nd2 <- as.numeric(filter(t219, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98,  clase2 == 4, clase1==2) %>% summarise(sum(fac)))
nd3 <- as.numeric(filter(t319, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98,  clase2 == 4, clase1==2) %>% summarise(sum(fac)))
nd4 <- as.numeric(filter(t419, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98,  clase2 == 4, clase1==2) %>% summarise(sum(fac)))
#La Población No Económicamente Activa está tada por Pob. Disponible + Pob. No Disponible.
#Por lo tanto, la fracción de trabajadores disponibles está dada por Pob. Disponible / (Pob. Disponible + Pob. No Disponible)
Td1 <- disp1/(disp1 + nd1)*100
Td2 <- disp2/(disp2 + nd2)*100
Td1 <- disp1/(disp2 + nd2)*100
Td1 <- disp1/(disp2 + nd2)*100
disp <- data.frame(Disponibilidad = c(Td1, Td2, Td3, Td4),
row.names = c('Trimestre I','Trimestre II','Trimestre III','Trimestre IV'))
Td1 <- disp1/(disp1 + nd1)*100
Td2 <- disp2/(disp2 + nd2)*100
Td3 <- disp3/(disp3 + nd3)*100
Td4 <- disp4/(disp4 + nd4)*100
disp <- data.frame(Disponibilidad = c(Td1, Td2, Td3, Td4),
row.names = c('Trimestre I','Trimestre II','Trimestre III','Trimestre IV'))
knitr::kable(suboc, booktabs = TRUE, format = 'latex', longtable = F
)%>%
kable_styling(latex_options = "hold_position", "center")
disp_ <- data.frame(Trimestre = c(' I',' II',' III',' IV'),
Dispt = c(Td1, Td2, Td3, Td4))
g3 <- ggplot(disp_, aes(Trimestre,Dispt)) + geom_bar(stat = "identity", fill = "gray", color = "black", width = 0.6) + theme_bw() + labs(title = "Tasa de Disponibilidad 2019", xlab = " Trimestre ", y="Porcentaje") +  theme(text=element_text(size=12,  family="serif"))
knitr::kable(unemp, booktabs = TRUE, format = 'latex', longtable = F, caption = "Tasas trimestrales de desempleo 2019"
)%>%
kable_styling(latex_options = "hold_position", "center")
peq <- as.numeric(filter(t119, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98, pos_ocu==1, ambito2==4 ) %>% summarise(sum(fac)))
peq1 <- as.numeric(filter(t119, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98, pos_ocu==1, ambito2==4 ) %>% summarise(sum(fac)))
peq2<- as.numeric(filter(t219, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98, pos_ocu==1, ambito2==4 ) %>% summarise(sum(fac)))
peq3 <- as.numeric(filter(t319, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98, pos_ocu==1, ambito2==4 ) %>% summarise(sum(fac)))
peq4 <- as.numeric(filter(t419, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98, pos_ocu==1, ambito2==4 ) %>% summarise(sum(fac)))
med1 <- as.numeric(filter(t119, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98, pos_ocu==1, ambito2==5) %>% summarise(sum(fac)))
med2<- as.numeric(filter(t219, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98, pos_ocu==1, ambito2==5) %>% summarise(sum(fac)))
med3 <- as.numeric(filter(t319, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98, pos_ocu==1, ambito2==5) %>% summarise(sum(fac)))
med4 <- as.numeric(filter(t419, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98, pos_ocu==1, ambito2==5) %>% summarise(sum(fac)))
gra1 <- as.numeric(filter(t119, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98, pos_ocu==1, ambito2==6) %>% summarise(sum(fac)))
gra2<- as.numeric(filter(t219, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98, pos_ocu==1, ambito2==6) %>% summarise(sum(fac)))
gra3 <- as.numeric(filter(t319, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98, pos_ocu==1, ambito2==6) %>% summarise(sum(fac)))
gra4 <- as.numeric(filter(t419, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98, pos_ocu==1, ambito2==6) %>% summarise(sum(fac)))
tamano <- data.frame(Pequeña = c(peq1,peq2,peq3,peq4),
Mediana = c(med1,med2,med3,med4),
Grande = c(gra1, gra2, gra3, gra4),
row.names = c('Trimestre I','Trimestre II', 'Trimestre III','Trimestre IV'))
View(tamano)
knitr::kable(tamano, booktabs = TRUE, format = 'latex', longtable = F,
caption = "Numero de empleados por tamaño de establecimiento"
)%>%
kable_styling(latex_options = "hold_position", "center")
tamano <- data.frame(Pequeña = c(peq1,peq2,peq3,peq4),
Mediana = c(med1,med2,med3,med4),
Grande = c(gra1, gra2, gra3, gra4),
Total = Pequeña + Mediana + Grande
row.names = c('Trimestre I','Trimestre II', 'Trimestre III','Trimestre IV'))
tamano <- data.frame(Pequeña = c(peq1,peq2,peq3,peq4),
Mediana = c(med1,med2,med3,med4),
Grande = c(gra1, gra2, gra3, gra4),
row.names = c('Trimestre I','Trimestre II', 'Trimestre III','Trimestre IV'))
tamano <- tamano %>% mutate(tamano, Total = Pequeña + Mediana + Grande)
tit <- tamano %>% tamano$Pequeña / tamano$Total
tit <- tamano %>% (tamano$Pequeña) / (tamano$Total)
tit <- data.frame(Pequeña = c(peq1,peq2,peq3,peq4),
Mediana = c(med1,med2,med3,med4),
Grande = c(gra1, gra2, gra3, gra4),
row.names = c('Trimestre I','Trimestre II', 'Trimestre III','Trimestre IV')))
tit <- data.frame(Pequeña = c(peq1/(peq1+med1+gra1),peq2/(peq2+med2+gra2),peq3/(peq3+med3+gra3),peq4/(peq4+med4+gra4)),
Mediana = c(med1/(peq1+med1+gra1),med2/(peq2+med2+gra2),med3/(peq3+med3+gra3),med4/(peq4+med4+gra4)),
Grande = c(gra1/(peq1+med1+gra1), gra2/(peq2+med2+gra2), gra3/(peq3+med3+gra3), gra4/(peq4+med4+gra4)),
row.names = c('Trimestre I','Trimestre II', 'Trimestre III','Trimestre IV'))
View(tit)
tit <- data.frame(Pequeña = c(peq1/(peq1+med1+gra1),peq2/(peq2+med2+gra2),peq3/(peq3+med3+gra3),peq4/(peq4+med4+gra4))*100,
Mediana = c(med1/(peq1+med1+gra1),med2/(peq2+med2+gra2),med3/(peq3+med3+gra3),med4/(peq4+med4+gra4)),
Grande = c(gra1/(peq1+med1+gra1), gra2/(peq2+med2+gra2), gra3/(peq3+med3+gra3), gra4/(peq4+med4+gra4)),
row.names = c('Trimestre I','Trimestre II', 'Trimestre III','Trimestre IV'))
tit <- data.frame(Pequeña = c(peq1/(peq1+med1+gra1),peq2/(peq2+med2+gra2),peq3/(peq3+med3+gra3),peq4/(peq4+med4+gra4)),
Mediana = c(med1/(peq1+med1+gra1),med2/(peq2+med2+gra2),med3/(peq3+med3+gra3),med4/(peq4+med4+gra4)),
Grande = c(gra1/(peq1+med1+gra1), gra2/(peq2+med2+gra2), gra3/(peq3+med3+gra3), gra4/(peq4+med4+gra4)),
row.names = c('Trimestre I','Trimestre II', 'Trimestre III','Trimestre IV'))
tit <- data.frame(Pequeña = c(peq1/(peq1+med1+gra1),peq2/(peq2+med2+gra2),peq3/(peq3+med3+gra3),peq4/(peq4+med4+gra4))*100,
Mediana = c(med1/(peq1+med1+gra1),med2/(peq2+med2+gra2),med3/(peq3+med3+gra3),med4/(peq4+med4+gra4)),
Grande = c(gra1/(peq1+med1+gra1), gra2/(peq2+med2+gra2), gra3/(peq3+med3+gra3), gra4/(peq4+med4+gra4)),
row.names = c('Trimestre I','Trimestre II', 'Trimestre III','Trimestre IV'))
tit <- data.frame(Pequeña = c(peq1/(peq1+med1+gra1),peq2/(peq2+med2+gra2),peq3/(peq3+med3+gra3),peq4/(peq4+med4+gra4))*100,
Mediana = c(med1/(peq1+med1+gra1),med2/(peq2+med2+gra2),med3/(peq3+med3+gra3),med4/(peq4+med4+gra4))*100,
Grande = c(gra1/(peq1+med1+gra1), gra2/(peq2+med2+gra2), gra3/(peq3+med3+gra3), gra4/(peq4+med4+gra4))*100,
row.names = c('Trimestre I','Trimestre II', 'Trimestre III','Trimestre IV'))
knitr::kable(tit, booktabs = TRUE, format = 'latex', longtable = F,
caption = "Numero de empleados por tamaño de establecimiento"
)%>%
kable_styling(latex_options = "hold_position", "center")
legend ("topleft",c("Week1","Week2","Week3","Week4","Week5"),cex=2.0,bty="n",fill=rainbow (5))
ggplot(data=tamano,
aes(x=Trimestre, fill=Tamano)) +
geom_bar(position="dodge")
Trimestre <- c('I','II','III','IV')
ggplot(data=tamano,
aes(x=Trimestre, fill=Tamano)) +
geom_bar(position="dodge")
ggplot(data=tamano,
aes(x=Trimestre, fill=tamano)) +
geom_bar(position="dodge")
Pequeña <- c(peq1,peq2,peq3,peq4)
Mediana <- c(med1,med2,med3,med4)
Grande <- c(gra1, gra2, gra3, gra4)
Tamano <- c(Pequeña, Mediana, Grande)
Trimestre <- c('I','II','III','IV')
ggplot(data=tamano,
aes(x=Trimestre, fill=tamano)) +
geom_bar(position="dodge")
ggplot(data=tamano,
aes(x=Tamano, fill=Trimestre)) +
geom_bar(position="dodge")
ggplot(data=Tamano,
aes(x=Tamano, fill=Trimestre)) +
geom_bar(position="dodge")
Pequeña <- c(peq1,peq2,peq3,peq4)
Mediana <- c(med1,med2,med3,med4)
Grande <- c(gra1, gra2, gra3, gra4)
Tamanio <- c(Pequeña, Mediana, Grande)
Trimestre <- c('I','II','III','IV')
ggplot(data=tamano,
aes(x=Tamanio, fill=Trimestre)) +
geom_bar(position="dodge")
tamano2 <- data.frame(Pequeña = c(peq1,peq2,peq3,peq4),
Mediana = c(med1,med2,med3,med4),
Grande = c(gra1, gra2, gra3, gra4),
Trimestre = c('Trimestre I','Trimestre II', 'Trimestre III','Trimestre IV'))
ggplot(data=tamano2,
aes(x=Tamanio, fill=Trimestre)) +
geom_bar(position="dodge")
ggplot(data=tamano2,
aes(x=tamano2, fill=Trimestre)) +
geom_bar(position="dodge")
ggplot(data=tamano2,
aes(x=Trimestre, fill=Pequeña)) +
geom_bar(position="dodge")
pacman::p_load(lattice)
barchart(x ~ Trimestre, data = tamano2, groups = tamano)
barchart(Trimestre ~ Trimestre, data = tamano2, groups = tamano)
barchart(Trimestre ~ Pequeña, data = tamano2, groups = tamano)
barchart(Pequeña ~ Trimestre, data = tamano2, groups = tamano)
barchart(Pequeña ~ Trimestre, data = tamano2, groups = tamano2)
View(tamano2)
tamano2 <- data.frame(Trimestre = c('Trimestre I','Trimestre II', 'Trimestre III','Trimestre IV'),
Pequeña = c(peq1,peq2,peq3,peq4),
Mediana = c(med1,med2,med3,med4),
Grande = c(gra1, gra2, gra3, gra4),
)
tamano2 <- data.frame(Trimestre = c('Trimestre I','Trimestre II', 'Trimestre III','Trimestre IV'),
Pequeña = c(peq1,peq2,peq3,peq4),
Mediana = c(med1,med2,med3,med4),
Grande = c(gra1, gra2, gra3, gra4))
tamano2 <- data.frame(Trimestre = c('Trimestre I','Trimestre II', 'Trimestre III','Trimestre IV'),
Pequeña = c(peq1,peq2,peq3,peq4),
Mediana = c(med1,med2,med3,med4),
Grande = c(gra1, gra2, gra3, gra4),
sub = LETTERS[1:4])
View(tamano2)
ggplot(tamano2,aes(x = Trimestre, y =Pequeña, fill = sub)) +
geom_bar(stat = "identity", position = "dodge")
tamano2 <- data.frame(Trimestre = c('Trimestre I','Trimestre II', 'Trimestre III','Trimestre IV'),
Tamaño = c(Pequeña,Mediana,Grande))
View(tamano2)
ggplot(tamano2,aes(x = Trimestre, y =Tamaño, fill = Tamaño)) +
geom_bar(stat = "identity", position = "dodge")
?rep
tamano2 <- data.frame(Trimestre = c('Trimestre I','Trimestre II', 'Trimestre III','Trimestre IV'),
Tamaño = c(Pequeña,Mediana,Grande),
nombre = c(rep('Pequeña',4), rep(4, 'Mediana'), rep('Grande',4)))
nombre = c(rep('Pequeña',4), rep(4, 'Mediana'), rep('Grande',4))
tamano2 <- data.frame(Trimestre = c('Trimestre I','Trimestre II', 'Trimestre III','Trimestre IV'),
Tamaño = c(Pequeña,Mediana,Grande),
nombre = c(rep('Pequeña',4), rep(4, 'Mediana'), rep('Grande',4)))
tamano2 <- data.frame(Trimestre = c('Trimestre I','Trimestre II', 'Trimestre III','Trimestre IV'),
Tamaño = c(Pequeña,Mediana,Grande),
nombre = c(rep('Pequeña',4), rep('Mediana', 4), rep('Grande',4)))
View(tamano2)
ggplot(tamano2,aes(x = Trimestre, y =Tamaño, fill = nombre)) +
geom_bar(stat = "identity", position = "dodge")
ggplot(tamano2,aes(x = nombre, y =Tamaño, fill = Trimestre)) +
geom_bar(stat = "identity", position = "dodge")
ggplot(tamano2,aes(x = nombre, y =Tamaño, fill = Trimestre)) +
geom_bar(stat = "identity", position = "dodge") + theme_bw()
ggplot(tamano2,aes(x = nombre, y =Tamaño, fill = Trimestre)) +
geom_bar(stat = "identity", position = "dodge") +
labs(title = "Numero de empleados por tamaño de empresas, 2019", x="Tamaño de Empresa",y='Número de Empleados',
colour = " ") + theme_bw() +  theme(text=element_text(size=12,  family="serif")) + theme_bw()
ggplot(tamano2,aes(x = nombre, y =Tamaño, fill = Trimestre)) +
geom_bar(stat = "identity", position = "dodge") +
labs(title = "Numero de empleados por tamaño de empresas, 2019", x="Tamaño de Empresa",y='Número de Empleados') + theme_bw() +  theme(text=element_text(size=12,  family="serif")) + theme_bw()
ggplot(tamano2,aes(x = nombre, y =Tamaño, fill = Trimestre)) +
geom_bar(stat = "identity", position = "dodge") +
labs(title = "Numero de empleados por tamaño de empresas (2019)", x="Tamaño de Empresa",y='Número de Empleados') + theme_bw() +  theme(text=element_text(size=12,  family="serif")) + theme_bw()
ggplot(tamano2,aes(x = nombre, y =Tamaño, fill = Trimestre)) +
geom_bar(stat = "identity", position = "dodge") +
labs(title = "Número de empleados por tamaño de empresas (2019)", x="Tamaño de Empresa",y='Número de Empleados') + theme_bw() +  theme(text=element_text(size=12,  family="serif")) + theme_bw() +  ylim(5000000,8000000)
ggplot(tamano2,aes(x = nombre, y =Tamaño, fill = Trimestre)) +
geom_bar(stat = "identity", position = "dodge") +
labs(title = "Número de empleados por tamaño de empresas (2019)", x="Tamaño de Empresa",y='Número de Empleados') + theme_bw() +  theme(text=element_text(size=12,  family="serif")) + theme_bw() +  scale_y_continuous(name=" ", limits=c(0, 150))
ggplot(tamano2,aes(x = nombre, y =Tamaño, fill = Trimestre)) +
geom_bar(stat = "identity", position = "dodge") +
labs(title = "Número de empleados por tamaño de empresas (2019)", x="Tamaño de Empresa",y='Número de Empleados') + theme_bw() +  theme(text=element_text(size=12,  family="serif")) + theme_bw()
tamano2$Tamaño <- as.numeric(tamano2$Tamaño)
ggplot(tamano2,aes(x = nombre, y =Tamaño, fill = Trimestre)) +
geom_bar(stat = "identity", position = "dodge") +
scale_y_continuous(breaks = seq(10000000,30000000,1000000)) +
labs(title = "Número de empleados por tamaño de empresas (2019)", x="Tamaño de Empresa",y='Número de Empleados') + theme_bw() +  theme(text=element_text(size=12,  family="serif")) + theme_bw()
ggplot(tamano2,aes(x = nombre, y =Tamaño, fill = Trimestre)) +
geom_bar(stat = "identity", position = "dodge") +
scale_y_continuous() +
labs(title = "Número de empleados por tamaño de empresas (2019)", x="Tamaño de Empresa",y='Número de Empleados') + theme_bw() +  theme(text=element_text(size=12,  family="serif")) + theme_bw()
scientific_10 <- function(x) {
parse(text=gsub("e", " %*% 10^", scales::scientific_format()(x)))
}
ggplot(tamano2,aes(x = nombre, y =Tamaño, fill = Trimestre)) +
geom_bar(stat = "identity", position = "dodge") +
scale_y_continuous() +
labs(title = "Número de empleados por tamaño de empresas (2019)", x="Tamaño de Empresa",y='Número de Empleados') + theme_bw() +  theme(text=element_text(size=12,  family="serif")) + +scale_y_continuous(label=scientific_10) + theme_bw()
ggplot(tamano2,aes(x = nombre, y =Tamaño, fill = Trimestre)) +
geom_bar(stat = "identity", position = "dodge") +
scale_y_continuous() +
labs(title = "Número de empleados por tamaño de empresas (2019)", x="Tamaño de Empresa",y='Número de Empleados') + theme_bw() +  theme(text=element_text(size=12,  family="serif")) + scale_y_continuous(label=scientific_10) + theme_bw()
ggplot(tamano2,aes(x = nombre, y =Tamaño, fill = Trimestre)) +
geom_bar(stat = "identity", position = "dodge") +
scale_y_continuous() +
labs(title = "Número de empleados por tamaño de empresas (2019)", x="Tamaño de Empresa",y='Número de Empleados') + theme_bw() +  theme(text=element_text(size=12,  family="serif")) + scale_y_continuous(limits = c(0,8000000)) + theme_bw()
pacman::p_load(scales)
ggplot(tamano2,aes(x = nombre, y =Tamaño, fill = Trimestre)) +
geom_bar(stat = "identity", position = "dodge") +
scale_y_continuous() +
labs(title = "Número de empleados por tamaño de empresas (2019)", x="Tamaño de Empresa",y='Número de Empleados') + theme_bw() +  theme(text=element_text(size=12,  family="serif")) + scale_y_continuous(limits = comma) + theme_bw()
ggplot(tamano2,aes(x = nombre, y =Tamaño, fill = Trimestre)) +
geom_bar(stat = "identity", position = "dodge") +
scale_y_continuous() +
labs(title = "Número de empleados por tamaño de empresas (2019)", x="Tamaño de Empresa",y='Número de Empleados') + theme_bw() +  theme(text=element_text(size=12,  family="serif")) + scale_y_continuous(limits = comma) + theme_bw()
ggplot(tamano2,aes(x = nombre, y =Tamaño, fill = Trimestre)) +
geom_bar(stat = "identity", position = "dodge") +
scale_y_continuous() +
labs(title = "Número de empleados por tamaño de empresas (2019)", x="Tamaño de Empresa",y='Número de Empleados') + theme_bw() +  theme(text=element_text(size=12,  family="serif")) + scale_y_continuous(labels = comma) + theme_bw()
"darkblue")
ggplot(tamano2,aes(x = nombre, y =Tamaño, fill = Trimestre)) +
geom_bar(stat = "identity", position = "dodge", colour = ) +
scale_y_continuous() +
labs(title = "Número de empleados por tamaño de empresas (2019)", x="Tamaño de Empresa",y='Número de Empleados') + theme_bw() +  theme(text=element_text(size=12,  family="serif")) + scale_y_continuous(labels = comma) + theme_bw() + scale_fill_manual(values=c("#9933FF",
"#33FFFF",
"red",
"darkblue"))
ggplot(tamano2,aes(x = nombre, y =Tamaño, fill = Trimestre)) +
geom_bar(stat = "identity", position = "dodge", colour = ) +
scale_y_continuous() +
labs(title = "Número de empleados por tamaño de empresas (2019)", x="Tamaño de Empresa",y='Número de Empleados') + theme_bw() +  theme(text=element_text(size=12,  family="serif")) + scale_y_continuous(labels = comma) + theme_bw()
ggplot(tamano2,aes(x = nombre, y =Tamaño, fill = Trimestre)) +
geom_bar(stat = "identity", position = "dodge", colour = ) +
scale_y_continuous() +
labs(title = "Número de empleados por tamaño de empresas (2019)", x="Tamaño de Empresa",y='Número de Empleados') + theme_bw() +  theme(text=element_text(size=12,  family="serif")) + scale_y_continuous(labels = comma) + theme_bw()
#Empleados en establecimientos pequeños
peq1 <- as.numeric(filter(t119, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98, pos_ocu==1, ambito2==4 ) %>% summarise(sum(fac)))
peq2<- as.numeric(filter(t219, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98, pos_ocu==1, ambito2==4 ) %>% summarise(sum(fac)))
peq3 <- as.numeric(filter(t319, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98, pos_ocu==1, ambito2==4) %>% summarise(sum(fac)))
peq4 <- as.numeric(filter(t419, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98, pos_ocu==1, ambito2==4) %>% summarise(sum(fac)))
#Empleados en establecimientos medianos
med1 <- as.numeric(filter(t119, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98, pos_ocu==1, ambito2==5) %>% summarise(sum(fac)))
med2<- as.numeric(filter(t219, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98, pos_ocu==1, ambito2==5) %>% summarise(sum(fac)))
med3 <- as.numeric(filter(t319, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98, pos_ocu==1, ambito2==5) %>% summarise(sum(fac)))
med4 <- as.numeric(filter(t419, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98, pos_ocu==1, ambito2==5) %>% summarise(sum(fac)))
#Empleados en establecimientos grandes
gra1 <- as.numeric(filter(t119, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98, pos_ocu==1, ambito2==6) %>% summarise(sum(fac)))
gra2<- as.numeric(filter(t219, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98, pos_ocu==1, ambito2==6) %>% summarise(sum(fac)))
gra3 <- as.numeric(filter(t319, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98, pos_ocu==1, ambito2==6) %>% summarise(sum(fac)))
gra4 <- as.numeric(filter(t419, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98, pos_ocu==1, ambito2==6) %>% summarise(sum(fac)))
tamano <- data.frame(Pequeña = c(peq1,peq2,peq3,peq4),
Mediana = c(med1,med2,med3,med4),
Grande = c(gra1, gra2, gra3, gra4),
row.names = c('Trimestre I','Trimestre II', 'Trimestre III','Trimestre IV'))
tamano <- tamano %>% mutate(tamano, Total = Pequeña + Mediana + Grande)
knitr::kable(tamano, booktabs = TRUE, format = 'latex', longtable = F,
caption = "Numero de empleados por tamaño de empresa"
)%>%
kable_styling(latex_options = "hold_position", "center")
tit <- data.frame(Pequeña = c(peq1/(peq1+med1+gra1),peq2/(peq2+med2+gra2),peq3/(peq3+med3+gra3),peq4/(peq4+med4+gra4))*100,
Mediana = c(med1/(peq1+med1+gra1),med2/(peq2+med2+gra2),med3/(peq3+med3+gra3),med4/(peq4+med4+gra4))*100,
Grande = c(gra1/(peq1+med1+gra1), gra2/(peq2+med2+gra2), gra3/(peq3+med3+gra3), gra4/(peq4+med4+gra4))*100,
row.names = c('Trimestre I','Trimestre II', 'Trimestre III','Trimestre IV'))
knitr::kable(tit, booktabs = TRUE, format = 'latex', longtable = F,
caption = "Numero de empleados por tamaño de establecimiento"
)%>%
kable_styling(latex_options = "hold_position", "center")
tamano2 <- data.frame(Trimestre = c('Trimestre I','Trimestre II', 'Trimestre III','Trimestre IV'),
Tamaño = c(Pequeña,Mediana,Grande),
nombre = c(rep('Pequeña',4), rep('Mediana', 4), rep('Grande',4)))
scientific_10 <- function(x) {
parse(text=gsub("e", " %*% 10^", scales::scientific_format()(x)))
}
pacman::p_load(scales)
ggplot(tamano2,aes(x = nombre, y =Tamaño, fill = Trimestre)) +
geom_bar(stat = "identity", position = "dodge", colour = ) +
scale_y_continuous() +
labs(title = "Número de empleados por tamaño de empresas (2019)", x="Tamaño de Empresa",y='Número de Empleados') + theme_bw() +  theme(text=element_text(size=12,  family="serif")) + scale_y_continuous(labels = comma) + theme_bw()
ggplot(tamano2,aes(x = nombre, y =Tamaño, fill = Trimestre)) +
geom_bar(stat = "identity", position = "dodge", colour = ) +
scale_y_continuous() +
labs(title = "Número de empleados por tamaño de empresas (2019)", x="Tamaño de Empresa",y='Número de Empleados') + theme_bw() +  theme(text=element_text(size=12,  family="serif")) + scale_y_continuous(labels = comma)
ggplot(tamano2,aes(x = nombre, y =Tamaño, fill = Trimestre)) +
geom_bar(stat = "identity", position = "dodge" ) +
scale_y_continuous() +
labs(title = "Número de empleados por tamaño de empresas (2019)", x="Tamaño de Empresa",y='Número de Empleados') + theme_bw() +  theme(text=element_text(size=12,  family="serif")) + scale_y_continuous(labels = comma)
Pequeña
tit <- data.frame(Pequeña = c(peq1/(peq1+med1+gra1),peq2/(peq2+med2+gra2),peq3/(peq3+med3+gra3),peq4/(peq4+med4+gra4))*100,
Mediana = c(med1/(peq1+med1+gra1),med2/(peq2+med2+gra2),med3/(peq3+med3+gra3),med4/(peq4+med4+gra4))*100,
Grande = c(gra1/(peq1+med1+gra1), gra2/(peq2+med2+gra2), gra3/(peq3+med3+gra3), gra4/(peq4+med4+gra4))*100,
row.names = c('Trimestre I','Trimestre II', 'Trimestre III','Trimestre IV'))
ggplot(tamano2,aes(x = nombre, y =Tamaño, fill = Trimestre)) +
geom_bar(stat = "identity", position = "dodge" ) +
scale_y_continuous() +
labs(title = "Número de empleados por tamaño de empresas (2019)", x="Tamaño de Empresa",y='Número de Empleados') + theme_bw() +  theme(text=element_text(size=12,  family="serif")) + scale_y_continuous(labels = comma)
Pequeña <- c(peq1,peq2,peq3,peq4)
Pequeña <- c(peq1,peq2,peq3,peq4)
Mediana <- c(med1,med2,med3,med4)
Grande <- c(gra1,gra2,gra3,gra4)
#Empleados en establecimientos pequeños
peq1 <- as.numeric(filter(t119, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98, pos_ocu==1, ambito2==4 ) %>% summarise(sum(fac)))
peq2<- as.numeric(filter(t219, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98, pos_ocu==1, ambito2==4 ) %>% summarise(sum(fac)))
peq3 <- as.numeric(filter(t319, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98, pos_ocu==1, ambito2==4) %>% summarise(sum(fac)))
peq4 <- as.numeric(filter(t419, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98, pos_ocu==1, ambito2==4) %>% summarise(sum(fac)))
#Empleados en establecimientos medianos
med1 <- as.numeric(filter(t119, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98, pos_ocu==1, ambito2==5) %>% summarise(sum(fac)))
med2<- as.numeric(filter(t219, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98, pos_ocu==1, ambito2==5) %>% summarise(sum(fac)))
med3 <- as.numeric(filter(t319, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98, pos_ocu==1, ambito2==5) %>% summarise(sum(fac)))
med4 <- as.numeric(filter(t419, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98, pos_ocu==1, ambito2==5) %>% summarise(sum(fac)))
#Empleados en establecimientos grandes
gra1 <- as.numeric(filter(t119, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98, pos_ocu==1, ambito2==6) %>% summarise(sum(fac)))
gra2<- as.numeric(filter(t219, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98, pos_ocu==1, ambito2==6) %>% summarise(sum(fac)))
gra3 <- as.numeric(filter(t319, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98, pos_ocu==1, ambito2==6) %>% summarise(sum(fac)))
gra4 <- as.numeric(filter(t419, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98, pos_ocu==1, ambito2==6) %>% summarise(sum(fac)))
tamano <- data.frame(Pequeña = c(peq1,peq2,peq3,peq4),
Mediana = c(med1,med2,med3,med4),
Grande = c(gra1, gra2, gra3, gra4),
row.names = c('Trimestre I','Trimestre II', 'Trimestre III','Trimestre IV'))
tamano <- tamano %>% mutate(tamano, Total = Pequeña + Mediana + Grande)
knitr::kable(tamano, booktabs = TRUE, format = 'latex', longtable = F,
caption = "Numero de empleados por tamaño de empresa"
)%>%
kable_styling(latex_options = "hold_position", "center")
tit <- data.frame(Pequeña = c(peq1/(peq1+med1+gra1),peq2/(peq2+med2+gra2),peq3/(peq3+med3+gra3),peq4/(peq4+med4+gra4))*100,
Mediana = c(med1/(peq1+med1+gra1),med2/(peq2+med2+gra2),med3/(peq3+med3+gra3),med4/(peq4+med4+gra4))*100,
Grande = c(gra1/(peq1+med1+gra1), gra2/(peq2+med2+gra2), gra3/(peq3+med3+gra3), gra4/(peq4+med4+gra4))*100,
row.names = c('Trimestre I','Trimestre II', 'Trimestre III','Trimestre IV'))
knitr::kable(tit, booktabs = TRUE, format = 'latex', longtable = F,
caption = "Numero de empleados por tamaño de establecimiento"
)%>%
kable_styling(latex_options = "hold_position", "center")
Pequeña <- c(peq1,peq2,peq3,peq4)
Mediana <- c(med1,med2,med3,med4)
Grande <- c(gra1,gra2,gra3,gra4)
tamano2 <- data.frame(Trimestre = c('Trimestre I','Trimestre II', 'Trimestre III','Trimestre IV'),
Tamaño = c(Pequeña,Mediana,Grande),
nombre = c(rep('Pequeña',4), rep('Mediana', 4), rep('Grande',4)))
pacman::p_load(scales)
ggplot(tamano2,aes(x = nombre, y =Tamaño, fill = Trimestre)) +
geom_bar(stat = "identity", position = "dodge" ) +
scale_y_continuous() +
labs(title = "Número de empleados por tamaño de empresas (2019)", x="Tamaño de Empresa",y='Número de Empleados') + theme_bw() +  theme(text=element_text(size=12,  family="serif")) + scale_y_continuous(labels = comma)
