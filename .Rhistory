filter(clase1 == 1, eda == 15)%>%
summarise(avg_ing= mean(ing_x_hrs))
a <- as.numeric(a)
b <- t119 %>%
filter(clase1 == 1, eda == 20)%>%
summarise(avg_ing= mean(ing_x_hrs))
b <- as.numeric(b)
c <- t119 %>%
filter(clase1 == 1, eda == 25)%>%
summarise(avg_ing= mean(ing_x_hrs))
c <- as.numeric(c)
d <- t119 %>%
filter(clase1 == 1, eda == 30)%>%
summarise(avg_ing= mean(ing_x_hrs))
d <- as.numeric(d)
e <- t119 %>%
filter(clase1 == 1, eda == 35)%>%
summarise(avg_ing= mean(ing_x_hrs))
e <- as.numeric(e)
f <- t119 %>%
filter(clase1 == 1, eda == 40)%>%
summarise(avg_ing= mean(ing_x_hrs))
f <- as.numeric(f)
g <- t119 %>%
filter(clase1 == 1, eda == 45)%>%
summarise(avg_ing= mean(ing_x_hrs))
g <- as.numeric(g)
h <- t119 %>%
filter(clase1 == 1, eda == 50)%>%
summarise(avg_ing= mean(ing_x_hrs))
h <- as.numeric(h)
i <- t119 %>%
filter(clase1 == 1, eda == 55)%>%
summarise(avg_ing= mean(ing_x_hrs))
i <- as.numeric(i)
j <- t119 %>%
filter(clase1 == 1, eda == 60)%>%
summarise(avg_ing= mean(ing_x_hrs))
j <- as.numeric(j)
k <- t119 %>%
filter(clase1 == 1, eda == 65)%>%
summarise(avg_ing= mean(ing_x_hrs))
k <- as.numeric(k)
l <- t119 %>%
filter(clase1 == 1, eda == 70)%>%
summarise(avg_ing= mean(ing_x_hrs))
l <- as.numeric(l)
m <- t119 %>%
filter(clase1 == 1, eda == 75)%>%
summarise(avg_ing= mean(ing_x_hrs))
m <- as.numeric(m)
n <- t119 %>%
filter(clase1 == 1, eda == 80)%>%
summarise(avg_ing= mean(ing_x_hrs))
n <- as.numeric(n)
o <- t119 %>%
filter(clase1 == 1, eda == 85)%>%
summarise(avg_ing= mean(ing_x_hrs))
o <- as.numeric(o)
p <- t119 %>%
filter(clase1 == 1, eda == 90)%>%
summarise(avg_ing= mean(ing_x_hrs))
p <- as.numeric(p)
Ingreso <- c(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p)
Edad <- c(15,20,25,30,25,40,45,50,55,60,65,70,75,80,85,90)
df <- data.frame(Edad = Edad, Ingreso = Ingreso)
ggplot(aes(Edad, Ingreso)) + geom_plot()
df <- data.frame(Edd = Edad, ing = Ingreso)
ggplot(aes(Edad, Ingreso)) + geom_plot()
ggplot(df, aes(Edad, Ingreso)) + geom_plot()
ggplot(df, aes(Edad, Ingreso)) + geom_dotplot()
Ingreso <- c(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p)
Edad <- c(15,20,25,30,25,40,45,50,55,60,65,70,75,80,85,90)
df <- data.frame(Edd = Edad, ing = Ingreso)
df
ggplot(df, aes(Edd, ing)) + geom_dotplot()
ggplot(df, aes(Edd,ing)) + geom_dotplot()
ggplot(df, aes(Edd,ing)) + geom_point()
ggplot(df, aes(Edd,ing)) + geom_point(colour="red", size=3) + labs(title = "Número de empleados por tamaño de empresas (2019)", x="Tamaño de Empresa",y='Número de Empleados') + theme_bw() +  theme(text=element_text(size=12,  family="serif"))
ggplot(df, aes(Edd,ing)) + geom_point(colour="red", size=3) + labs(title = "Relación (2019)", x="Edad",y="Ingreso por hora") + theme_bw() +  theme(text=element_text(size=12,  family="serif"))
ggplot(df, aes(Edd,ing)) + geom_point(colour="red", size=3) + labs(title = "Relación entre Edad e Ingreso (2019)", x="Edad",y="Ingreso por hora") + theme_bw() +  theme(text=element_text(size=12,  family="serif"))
ggplot(df, aes(Edd,ing)) + geom_point(colour="coral2", size=3) + labs(title = "Relación entre Edad e Ingreso (2019)", x="Edad",y="Ingreso por hora") + theme_bw() +  theme(text=element_text(size=12,  family="serif"))
ggplot(df, aes(Edd,ing)) + geom_point(colour="cornflowerblue", size=3) + labs(title = "Relación entre Edad e Ingreso (2019)", x="Edad",y="Ingreso por hora") + theme_bw() +  theme(text=element_text(size=12,  family="serif"))
ggplot(df, aes(Edd,ing)) + geom_point(colour="brown", size=3) + labs(title = "Relación entre Edad e Ingreso (2019)", x="Edad",y="Ingreso por hora") + theme_bw() +  theme(text=element_text(size=12,  family="serif"))
z <- t119 %>%
filter(clase1 == 1, eda == 90)%>%
summarise(avg_ing= as.numeric(mean(ing_x_hrs)))
z
z <- t119 %>%
filter(clase1 == 1, eda == 90)%>%
as.numeric(summarise(avg_ing = (mean(ing_x_hrs))))
summarise(as.numeric(avg_ing) = (mean(ing_x_hrs))
z <- t119 %>%
filter(clase1 == 1, eda == 90)%>%
as.numeric(summarise(avg_ing = mean(ing_x_hrs)))
z <- t119 %>%
filter(clase1 == 1, eda == 90)%>%
summarise(avg_ing = mean(ing_x_hrs)) %>% as.numeric(z)
z
da <- t219 %>%
filter(clase1 == 1, eda == 90)%>%
summarise(avg_ing = mean(ing_x_hrs)) %>% as.numeric(da)
da <- t219 %>%
filter(clase1 == 1, eda == 90)%>%
summarise(avg_ing = mean(ing_x_hrs)) %>% as.numeric(da)
da <- t219 %>%
filter(clase1 == 1, eda == 90)%>%
summarise(avg_ing = mean(ing_x_hrs)) %>% as.numeric(da)
ggplot(df, aes(Edd,ing)) + geom_point(colour="brown", size=3) + labs(title = "Relación entre Edad e Ingreso (2019)", x="Edad",y="Ingreso por hora") + theme_bw() +  theme(text=element_text(size=12,  family="serif"))
ggplot(df, aes(Edd,ing)) + geom_point(colour="brown", size=2) + labs(title = "Relación entre Edad e Ingreso (2019)", x="Edad",y="Ingreso por hora") + theme_bw() +  theme(text=element_text(size=12,  family="serif"))
ggplot(df, aes(Edd,ing)) + geom_point(colour="brown", size=2.5) + labs(title = "Relación entre Edad e Ingreso (2019)", x="Edad",y="Ingreso por hora") + theme_bw() +  theme(text=element_text(size=12,  family="serif"))
ggplot(tamano2,aes(x = nombre, y =Tamaño, fill = Trimestre)) +
geom_bar(stat = "identity", position = "dodge" ) +
labs(title = "Número de empleados por tamaño de empresas (2019)", x="Tamaño de Empresa",y='Número de Empleados') + theme_bw() +  theme(text=element_text(size=12,  family="serif")) + scale_y_continuous(labels = comma)
pacman::p_load(tidyverse,
ggthemes,
haven, readxl,
kableExtra,
cowplot, ggplot2, scales, viridis, latticeExtra,
knitr, tinytex, reshape, lubridate, scales, reshape2)
matriz_hus <- read_excel("matriz.xlsx", sheet = 2)
View(matriz_hus)
knitr::kable(suboc, booktabs = TRUE, format = 'latex', longtable = F
)%>%
add_header_above(c(" ", "Asalariados" = 2, "Con percepciones no salariales" = 2)) %>%
kable_styling(latex_options = "hold_position", "center")
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE, fig.align="center", fig.pos = "H", fig.width = 7, fig.height = 3)
pacman::p_load(tidyverse,
ggthemes,
haven, readxl,
kableExtra,
cowplot, ggplot2, scales, viridis, latticeExtra,
knitr, tinytex, reshape, lubridate, scales, reshape2)
salarios <- read.csv(file = "Salarios.csv", sep = ",")
salarios <- salarios[,-c(3,4)]
View(salarios)
sal08 <- salarios[2:13,-1]
sal08 <- mean(sal08)
sal09 <- salarios[15:26,-1]
sal09 <- mean(sal09)
sal10 <- salarios[28:39,-1]
sal10 <- mean(sal10)
sal11 <- salarios[41:52,-1]
sal11 <- mean(sal11)
sal12 <- salarios[54:65,-1]
sal12 <- mean(sal12)
sal13 <- salarios[67:78,-1]
sal13 <- mean(sal13)
sal14 <- salarios[80:91,-1]
sal14 <- mean(sal14)
sal15 <- salarios[93:104,-1]
sal15 <- mean(sal15)
sal16 <- salarios[106:117,-1]
sal16 <- mean(sal16)
sal17 <- salarios[119:130,-1]
sal17 <- mean(sal17)
sal18 <- salarios[132:143,-1]
sal18 <- mean(sal18)
sal19 <- salarios[145:156,-1]
sal19 <- mean(sal19)
sal20 <- salarios[158:169,-1]
sal20 <- mean(sal20)
sal21 <- salarios[171:178,-1]
sal21 <- mean(sal21)
sal_anual_real <- c(sal08, sal09, sal10, sal11, sal12, sal13, sal14, sal15, sal16, sal17,
sal18, sal19, sal20, sal21)
year <- c(2008:2021)
salr <- data.frame(year, sal_anual_real)
salr <- salr %>% mutate(Serie_1 = (sal_anual_real/lag(sal_anual_real)-1)*100)
options(knitr.kable.NA = "-")
knitr::kable(
salr, booktabs = TRUE, format = 'latex', col.names = c("Año", "Remuneración Media Real (Índice)","Variación %"),
caption = "Variación Porcentual de los Salarios Reales (2008 - 2021)"
)%>%
kable_styling(latex_options = "hold_position")
#Volatilidad
Serie_1 <- salr$Serie_1
vol_s1 <- sd(Serie_1, na.rm = T)
# Cambio Porcentual
empleo <- read_excel("Empleo.xls",
sheet = 1)
empleo$Periodos <- year(parse_date_time(empleo$Periodos, orders = "%Y/%q"))
empleo <- empleo %>% group_by(Periodos) %>% summarise(`PEA Ocupada`, PEA_Ocup_anualizado = mean(`PEA Ocupada`, na.rm=T), .groups = 'drop')
empleo <- empleo[!duplicated(empleo[c('PEA_Ocup_anualizado')]),]
empleo <- empleo %>% mutate(Serie_2 = (PEA_Ocup_anualizado/lag(PEA_Ocup_anualizado)-1)*100)
empleo <- empleo[,c(1,3,4)]
empleo <- na.omit(empleo)
knitr::kable(
empleo, booktabs = TRUE, format = 'latex', col.names = c("Año", "Población Ocupada","Variación %"),
caption = "Variación Porcentual de la Población Ocupada (2006 - 2021)", longtable = F
)%>%
kable_styling(latex_options = "hold_position")
# Volatilidad
Serie_2 <- empleo$Serie_2
vol_s2 <- sd(Serie_2, na.rm = T)
#Cambio Porcentual
datos <- read_excel("PIB_K.xls",
sheet = 1)
names(datos) = c('Periodo', 'Inversión', 'Indice K','PIB')
datos <- datos[-c(1:200),-c(2,3)]
datos$Periodo <- year(parse_date_time(datos$Periodo, orders = "%Y%q"))
datos <- na.omit(datos)
datos$PIB <- as.numeric(as.character(datos$PIB))
datos <- datos %>% group_by(Periodo) %>% summarise(PIB, PIB_an = mean(PIB), .groups = 'drop')
datos <- datos[!duplicated(datos[c('PIB_an')]),]
datos <- datos[,-2]
datos_pib <- datos %>% mutate(Serie_3 = (PIB_an/lag(PIB_an)-1)*100)
datos_pib <- na.omit(datos_pib)
knitr::kable(
datos_pib, booktabs = TRUE, format = 'latex', col.names = c("Año", "Producto Interno Bruto","Variación %"),
caption = "Variación Porcentual de los Salarios Reales (2008 - 2021)", longtable = F
)%>%
kable_styling(latex_options = "hold_position")
#Volatilidad
Serie_3 <- datos_pib$Serie_3
vol_s3 <- sd(Serie_3, na.rm = T)
Series <- datos_pib[,c(1,3)]
year <- datos_pib$Periodo
year <- year[-c(1,2)]
Serie1 <- salr$Serie_1
Serie2 <- empleo$Serie_2
Serie2 <- Serie2[-c(1,2)]
Serie3 <- datos_pib$Serie_3
Serie3 <- Serie3[-c(1,2)]
Series <- data.frame(year, Serie1, Serie2, Serie3)
pacman::p_load(extrafont)
meltdf <- melt(Series,id="year")
gg <- ggplot(meltdf,aes(x=year,y=value,colour=variable,group=variable)) + geom_line() +
labs(title = "Comparación de Variación Porcentual entre Series", x="Año",y='Variación Porcentual',
colour = " ") + theme_bw() +  theme(text=element_text(size=12,  family="serif"))
plot(gg)
# cov(Serie1[-1], Serie3[-1])
# cov(Serie_2, Serie_3)
#Cambio Porcentual
datos <- read_excel("PIB_K.xls",
sheet = 1)
names(datos) = c('Periodo', 'Inversión', 'Indice_K','PIB')
datos <- datos[-c(1:200),-2]
PIB <- datos[,-2]
PIB$Periodo <- year(parse_date_time(datos$Periodo, orders = "%Y%q"))
PIB <- na.omit(PIB)
PIB$PIB <- as.numeric(as.character(PIB$PIB))
PIB <- PIB %>% group_by(Periodo) %>% summarise(PIB, PIB_an = mean(PIB), .groups = 'drop')
PIB <- PIB[!duplicated(PIB[c('PIB_an')]),]
PIB <- PIB[,-2]
K <- datos[,-3]
K$Periodo <- year(parse_date_time(K$Periodo, orders = "%Y%m"))
K$Indice_K <- as.numeric(as.character(K$Indice_K))
K <- K %>% group_by(Periodo) %>% summarise(Indice_K, K_an = mean(Indice_K), .groups = 'drop')
K <- K[!duplicated(K[c('K_an')]),]
K <- na.omit(K)
K <- K[,-2]
empleo <- read_excel("Empleo.xls",
sheet = 1)
empleo$Periodos <- year(parse_date_time(empleo$Periodos, orders = "%Y/%q"))
empleo <- empleo %>% group_by(Periodos) %>% summarise(`PEA Ocupada`, PEA_Ocup_an = mean(`PEA Ocupada`, na.rm=T), .groups = 'drop')
empleo <- empleo[!duplicated(empleo[c('PEA_Ocup_an')]),]
empleo <- empleo
productividad <- empleo[,-2]
A <- PIB$PIB_an/(((K$K_an)^(0.3))*((empleo$PEA_Ocup_an)^(0.7)))
A <- as.vector(A, mode = "numeric")
A <- as.data.frame(A,t(A))
productividad <- productividad %>% add_column(A_t=A$A)
salario <- empleo[,-2]
w <- (0.7)*(productividad$A_t)*((K$K_an)^(0.3))*((empleo$PEA_Ocup_an)^(0.3))
w <- as.vector(w, mode = "numeric")
w <- as.data.frame(w,t(w))
salario <- salario %>% add_column(w=w$w)
matriz_hus <- read_excel("matriz.xlsx", sheet = 2)
knitr::kable(suboc, booktabs = TRUE, format = 'latex', longtable = F
)%>%
add_header_above(c(" ", "Asalariados" = 2, "Con percepciones no salariales" = 2)) %>%
kable_styling(latex_options = "hold_position", "center")
t119 <- read_csv("sdemt119.csv")
t219 <- read_csv("sdemt219.csv")
t319 <- read_csv("sdemt319.csv")
names(t319) <- tolower(names(t319))
t419 <- read_csv("sdemt419.csv")
names(t419) <- tolower(names(t419))
#Población Econóicamente Activa
PEA1 <- as.numeric(filter(t119, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98, clase1 == 1) %>% summarise(sum(fac)))
PEA2 <- as.numeric(filter(t219, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98, clase1 == 1) %>% summarise(sum(fac)))
PEA3 <- as.numeric(filter(t319, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98, clase1 == 1) %>% summarise(sum(fac)))
PEA4 <- as.numeric(filter(t419, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98, clase1 == 1) %>% summarise(sum(fac)))
#Población Ocupada
PO1 <- as.numeric(filter(t119, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98, clase2 == 1) %>% summarise(sum(fac)))
PO2 <- as.numeric(filter(t219, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98, clase2 == 1) %>% summarise(sum(fac)))
PO3 <- as.numeric(filter(t319, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98, clase2 == 1) %>% summarise(sum(fac)))
PO4 <- as.numeric(filter(t419, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98, clase2 == 1) %>% summarise(sum(fac)))
#Población Desocupada
PD1 <- as.numeric(filter(t119, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98, clase2 == 2) %>% summarise(sum(fac)))
PD2 <- as.numeric(filter(t219, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98, clase2 == 2) %>% summarise(sum(fac)))
PD3 <- as.numeric(filter(t319, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98, clase2 == 2) %>% summarise(sum(fac)))
PD4 <- as.numeric(filter(t419, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98, clase2 == 2) %>% summarise(sum(fac)))
#Tasa de desempleo
U_1 <- (PD1/PEA1)*100
U_2 <- (PD2/PEA2)*100
U_3 <- (PD3/PEA3)*100
U_4 <- (PD4/PEA4)*100
unemp <- data.frame(Desempleo = c(U_1,U_2,U_3,U_4),
row.names = c('Trimestre I','Trimestre II','Trimestre III','Trimestre IV'))
knitr::kable(unemp, booktabs = TRUE, format = 'latex', longtable = F
)%>%
kable_styling(latex_options = "hold_position", "center")
unemp_ <- data.frame(Trimestre = c(' I',' II',' III',' IV'),
desmp = c(U_1,U_2,U_3,U_4))
g1 <- ggplot(unemp_, aes(Trimestre,desmp)) + geom_bar(stat = "identity", fill = "darkolivegreen2", color = "black", width = 0.6) + theme_bw() + labs(title = "Tasa de Desempleo 2019", xlab = " Trimestre ", y="Porcentaje") +  theme(text=element_text(size=12,  family="serif"))
g1
#Población Subocupada
Sub1 <- as.numeric(filter(t119, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98, sub_o==1) %>% summarise(sum(fac)))
Sub2 <- as.numeric(filter(t219, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98, sub_o==1) %>% summarise(sum(fac)))
Sub3 <- as.numeric(filter(t319, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98, sub_o==1) %>% summarise(sum(fac)))
Sub4 <- as.numeric(filter(t419, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98, sub_o==1) %>% summarise(sum(fac)))
#Tasa de Subocupación
Tsub_1 <- (Sub1/PO1)*100
Tsub_2 <- (Sub2/PO2)*100
Tsub_3 <- (Sub3/PO3)*100
Tsub_4 <- (Sub4/PO4)*100
suboc <- data.frame(Subempleo = c(Tsub_1, Tsub_2, Tsub_3, Tsub_4),
row.names = c('Trimestre I','Trimestre II','Trimestre III','Trimestre IV'))
knitr::kable(suboc, booktabs = TRUE, format = 'latex', longtable = F
)%>%
kable_styling(latex_options = "hold_position", "center")
suboc_ <- data.frame(Trimestre = c(' I',' II',' III',' IV'),
subOC = c(Tsub_1, Tsub_2, Tsub_3, Tsub_4))
g2 <- ggplot(suboc_, aes(Trimestre,subOC)) + geom_bar(stat = "identity", fill = "darkorange2", color = "black", width = 0.6) + theme_bw() + labs(title = "Tasa de Subempleo 2019", xlab = " Trimestre ", y="Porcentaje") +  theme(text=element_text(size=12,  family="serif"))
g2
#Población Disponible
disp1 <- as.numeric(filter(t119, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98, clase2 == 3, clase1==2) %>% summarise(sum(fac)))
disp2 <- as.numeric(filter(t219, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98,  clase2 == 3, clase1==2) %>% summarise(sum(fac)))
disp3 <- as.numeric(filter(t319, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98,  clase2 == 3, clase1==2) %>% summarise(sum(fac)))
disp4 <- as.numeric(filter(t419, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98,  clase2 == 3, clase1==2) %>% summarise(sum(fac)))
#Población No Disponible
nd1 <- as.numeric(filter(t119, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98, clase2 == 4, clase1==2) %>% summarise(sum(fac)))
nd2 <- as.numeric(filter(t219, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98,  clase2 == 4, clase1==2) %>% summarise(sum(fac)))
nd3 <- as.numeric(filter(t319, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98,  clase2 == 4, clase1==2) %>% summarise(sum(fac)))
nd4 <- as.numeric(filter(t419, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98,  clase2 == 4, clase1==2) %>% summarise(sum(fac)))
#La Población No Económicamente Activa está tada por Pob. Disponible + Pob. No Disponible.
#Por lo tanto, la fracción de trabajadores disponibles está dada por Pob. Disponible / (Pob. Disponible + Pob. No Disponible)
Td1 <- disp1/(disp1 + nd1)*100
Td2 <- disp2/(disp2 + nd2)*100
Td3 <- disp3/(disp3 + nd3)*100
Td4 <- disp4/(disp4 + nd4)*100
disp <- data.frame(Disponibilidad = c(Td1, Td2, Td3, Td4),
row.names = c('Trimestre I','Trimestre II','Trimestre III','Trimestre IV'))
knitr::kable(disp, booktabs = TRUE, format = 'latex', longtable = F, caption = "Tasas de disponibilidad 2019"
)%>%
kable_styling(latex_options = "hold_position", "center")
disp_ <- data.frame(Trimestre = c(' I',' II',' III',' IV'),
Dispt = c(Td1, Td2, Td3, Td4))
g3 <- ggplot(disp_, aes(Trimestre,Dispt)) + geom_bar(stat = "identity", fill = "lightblue", color = "black", width = 0.6) + theme_bw() + labs(title = "Tasa de Disponibilidad 2019", xlab = " Trimestre ", y="Porcentaje") +  theme(text=element_text(size=12,  family="serif"))
g3
#Empleados en establecimientos pequeños
peq1 <- as.numeric(filter(t119, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98, pos_ocu==1, ambito2==4 ) %>% summarise(sum(fac)))
peq2<- as.numeric(filter(t219, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98, pos_ocu==1, ambito2==4 ) %>% summarise(sum(fac)))
peq3 <- as.numeric(filter(t319, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98, pos_ocu==1, ambito2==4) %>% summarise(sum(fac)))
peq4 <- as.numeric(filter(t419, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98, pos_ocu==1, ambito2==4) %>% summarise(sum(fac)))
#Empleados en establecimientos medianos
med1 <- as.numeric(filter(t119, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98, pos_ocu==1, ambito2==5) %>% summarise(sum(fac)))
med2<- as.numeric(filter(t219, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98, pos_ocu==1, ambito2==5) %>% summarise(sum(fac)))
med3 <- as.numeric(filter(t319, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98, pos_ocu==1, ambito2==5) %>% summarise(sum(fac)))
med4 <- as.numeric(filter(t419, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98, pos_ocu==1, ambito2==5) %>% summarise(sum(fac)))
#Empleados en establecimientos grandes
gra1 <- as.numeric(filter(t119, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98, pos_ocu==1, ambito2==6) %>% summarise(sum(fac)))
gra2<- as.numeric(filter(t219, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98, pos_ocu==1, ambito2==6) %>% summarise(sum(fac)))
gra3 <- as.numeric(filter(t319, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98, pos_ocu==1, ambito2==6) %>% summarise(sum(fac)))
gra4 <- as.numeric(filter(t419, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98, pos_ocu==1, ambito2==6) %>% summarise(sum(fac)))
tamano <- data.frame(Pequeña = c(peq1,peq2,peq3,peq4),
Mediana = c(med1,med2,med3,med4),
Grande = c(gra1, gra2, gra3, gra4),
row.names = c('Trimestre I','Trimestre II', 'Trimestre III','Trimestre IV'))
tamano <- tamano %>% mutate(tamano, Total = Pequeña + Mediana + Grande)
knitr::kable(tamano, booktabs = TRUE, format = 'latex', longtable = F,
caption = "Numero de empleados por tamaño de empresa"
)%>%
kable_styling(latex_options = "hold_position", "center")
tit <- data.frame(Pequeña = c(peq1/(peq1+med1+gra1),peq2/(peq2+med2+gra2),peq3/(peq3+med3+gra3),peq4/(peq4+med4+gra4))*100,
Mediana = c(med1/(peq1+med1+gra1),med2/(peq2+med2+gra2),med3/(peq3+med3+gra3),med4/(peq4+med4+gra4))*100,
Grande = c(gra1/(peq1+med1+gra1), gra2/(peq2+med2+gra2), gra3/(peq3+med3+gra3), gra4/(peq4+med4+gra4))*100,
row.names = c('Trimestre I','Trimestre II', 'Trimestre III','Trimestre IV'))
knitr::kable(tit, booktabs = TRUE, format = 'latex', longtable = F,
caption = "Numero de empleados por tamaño de establecimiento"
)%>%
kable_styling(latex_options = "hold_position", "center")
Pequeña <- c(peq1,peq2,peq3,peq4)
Mediana <- c(med1,med2,med3,med4)
Grande <- c(gra1,gra2,gra3,gra4)
tamano2 <- data.frame(Trimestre = c('Trimestre I','Trimestre II', 'Trimestre III','Trimestre IV'),
Tamaño = c(Pequeña,Mediana,Grande),
nombre = c(rep('Pequeña',4), rep('Mediana', 4), rep('Grande',4)))
pacman::p_load(scales)
ggplot(tamano2,aes(x = nombre, y =Tamaño, fill = Trimestre)) +
geom_bar(stat = "identity", position = "dodge" ) +
labs(title = "Número de empleados por tamaño de empresas (2019)", x="Tamaño de Empresa",y='Número de Empleados') + theme_bw() +  theme(text=element_text(size=12,  family="serif")) + scale_y_continuous(labels = comma)
busq1 <- as.numeric(filter(t119, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98, tpg_p8a == 1) %>% summarise(sum(fac)))
busq2 <- as.numeric(filter(t219, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98,  tpg_p8a == 1) %>% summarise(sum(fac)))
busq3 <- as.numeric(filter(t319, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98,  tpg_p8a == 1) %>% summarise(sum(fac)))
busq4 <- as.numeric(filter(t419, r_def == 0, c_res == 1 | c_res == 3, eda >= 15 & eda <= 98,  tpg_p8a == 1) %>% summarise(sum(fac)))
busq <- data.frame(Busqueda = c(busq1, busq2, busq3, busq4),
row.names = c('Trimestre I','Trimestre II','Trimestre III','Trimestre IV'))
knitr::kable(busq, booktabs = TRUE, format = 'latex', longtable = F, caption = "Empleados en búsqueda de otro empleo 2019"
)%>%
kable_styling(latex_options = "hold_position", "center")
busq_ <- data.frame(Trimestre = c(' I',' II',' III',' IV'),
busqu = c(busq1, busq2, busq3, busq4))
g3 <- ggplot(busq_, aes(Trimestre,busqu)) + geom_bar(stat = "identity", fill = "blue", color = "black", width = 0.6) + theme_bw() + labs(title = "Número de empleados en búsqueda de otro trabajo 2019", xlab = " Trimestre ", y="Porcentaje") +  theme(text=element_text(size=12,  family="serif")) +  scale_y_continuous(label = comma)
g3
a <- t119 %>%
filter(clase1 == 1, eda == 15)%>%
summarise(avg_ing= mean(ing_x_hrs))
a <- as.numeric(a)
b <- t119 %>%
filter(clase1 == 1, eda == 20)%>%
summarise(avg_ing= mean(ing_x_hrs))
b <- as.numeric(b)
c <- t119 %>%
filter(clase1 == 1, eda == 25)%>%
summarise(avg_ing= mean(ing_x_hrs))
c <- as.numeric(c)
d <- t119 %>%
filter(clase1 == 1, eda == 30)%>%
summarise(avg_ing= mean(ing_x_hrs))
d <- as.numeric(d)
e <- t119 %>%
filter(clase1 == 1, eda == 35)%>%
summarise(avg_ing= mean(ing_x_hrs))
e <- as.numeric(e)
f <- t119 %>%
filter(clase1 == 1, eda == 40)%>%
summarise(avg_ing= mean(ing_x_hrs))
f <- as.numeric(f)
g <- t119 %>%
filter(clase1 == 1, eda == 45)%>%
summarise(avg_ing= mean(ing_x_hrs))
g <- as.numeric(g)
h <- t119 %>%
filter(clase1 == 1, eda == 50)%>%
summarise(avg_ing= mean(ing_x_hrs))
h <- as.numeric(h)
i <- t119 %>%
filter(clase1 == 1, eda == 55)%>%
summarise(avg_ing= mean(ing_x_hrs))
i <- as.numeric(i)
j <- t119 %>%
filter(clase1 == 1, eda == 60)%>%
summarise(avg_ing= mean(ing_x_hrs))
j <- as.numeric(j)
k <- t119 %>%
filter(clase1 == 1, eda == 65)%>%
summarise(avg_ing= mean(ing_x_hrs))
k <- as.numeric(k)
l <- t119 %>%
filter(clase1 == 1, eda == 70)%>%
summarise(avg_ing= mean(ing_x_hrs))
l <- as.numeric(l)
m <- t119 %>%
filter(clase1 == 1, eda == 75)%>%
summarise(avg_ing= mean(ing_x_hrs))
m <- as.numeric(m)
n <- t119 %>%
filter(clase1 == 1, eda == 80)%>%
summarise(avg_ing= mean(ing_x_hrs))
n <- as.numeric(n)
o <- t119 %>%
filter(clase1 == 1, eda == 85)%>%
summarise(avg_ing= mean(ing_x_hrs))
o <- as.numeric(o)
p <- t119 %>%
filter(clase1 == 1, eda == 90)%>%
summarise(avg_ing= mean(ing_x_hrs))
p <- as.numeric(p)
Ingreso <- c(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p)
Edad <- c(15,20,25,30,25,40,45,50,55,60,65,70,75,80,85,90)
df <- data.frame(Edd = Edad, ing = Ingreso)
ggplot(df, aes(Edd,ing)) + geom_point(colour="brown", size=2.5) + labs(title = "Relación entre Edad e Ingreso (2019)", x="Edad",y="Ingreso por hora") + theme_bw() +  theme(text=element_text(size=12,  family="serif"))
knitr::kable(matriz_hus, booktabs = TRUE, format = 'latex', longtable = F
)%>%
add_header_above(c(" ", "Asalariados" = 2, "Con percepciones no salariales" = 2)) %>%
kable_styling(latex_options = "hold_position", "center")
names(matriz_hus) <- c("Tipo de unidad \n económica empleadora", "Informal", "Formal",
"Informal", "Formal","Informal", "Formal","Informal", "Formal","Informal", "Formal",
"Informal", "Formal", "Total")
knitr::kable(matriz_hus, booktabs = TRUE, format = 'latex', longtable = F
)%>%
add_header_above(c(" ", "Asalariados" = 2, "Con percepciones no salariales" = 2)) %>%
kable_styling(latex_options = "scale_down", "center")
knitr::kable(matriz_hus, booktabs = TRUE, format = 'latex', longtable = F)%>%
add_header_above(c(" ", "Asalariados" = 2, "Con percepciones \n no salariales" = 2,
"Empleadores" = 2, "Trabajadores por \n cuenta propia" = 2,
"Trabajadores \n no remunerados" = 2, "Subtotal por perspectiva de la \n unidad económica y/o laboral" = 2))%>% kable_styling(latex_options = "scale_down", "center")
knitr::kable(matriz_hus, booktabs = TRUE, format = 'latex', longtable = F)%>%
add_header_above(c(" ", "Asalariados" = 2, "Con percepciones \n no salariales" = 2,
"Empleadores" = 2, "Trabajadores por \n cuenta propia" = 2,
"Trabajadores \n no remunerados" = 2, "Subtotal por perspectiva de la \n unidad económica y/o laboral" = 2))%>%
add_header_above(c(" ", "Posición en la ocupación y condición de informalidad" = 12, bold = T, italitc = T))%>%
kable_styling(latex_options = "scale_down", "center")
matriz_hus <- read_excel("matriz.xlsx", sheet = 2)
names(matriz_hus) <- c("Tipo de unidad \n económica empleadora", "Informal", "Formal",
"Informal", "Formal","Informal", "Formal","Informal", "Formal","Informal", "Formal",
"Informal", "Formal", "Total")
knitr::kable(matriz_hus, booktabs = TRUE, format = 'latex', longtable = F)%>%
add_header_above(c(" ", "Asalariados" = 2, "Con percepciones \n no salariales" = 2,
"Empleadores" = 2, "Trabajadores por \n cuenta propia" = 2,
"Trabajadores \n no remunerados" = 2, "Subtotal por perspectiva de la \n unidad económica y/o laboral" = 2))%>%
add_header_above(c(" ", "Posición en la ocupación y condición de informalidad" = 12), bold = T, italic = T) %>%
kable_styling(latex_options = "scale_down", "center")
knitr::kable(matriz_hus, booktabs = TRUE, format = 'latex', caption = "Matriz Hussmanns para México, 4º Trimestre de 2019", longtable = F)%>%
add_header_above(c(" ", "Asalariados" = 2, "Con percepciones \n no salariales" = 2,
"Empleadores" = 2, "Trabajadores por \n cuenta propia" = 2,
"Trabajadores \n no remunerados" = 2, "Subtotal por perspectiva de la \n unidad económica y/o laboral" = 2))%>%
add_header_above(c(" ", "Posición en la ocupación y condición de informalidad" = 12), bold = T, italic = T) %>%
kable_styling(latex_options = "scale_down", "center")
